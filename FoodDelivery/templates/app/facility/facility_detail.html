{% extends 'app/base.html'%}

{% block content %}
<div class="fd-summary-container rounded shadow-lg">
    <h3>Shrnutí objednávky</h3>
    {% for entry in summary.order %}
        {{ entry.count }}x {{ entry.item.name }}
        <form method="GET">
            <button type="submit" class="btn btn-warning" name="remove_item" value="{{ entry.item.pk }}">Odebrat</button>
        </form>
    {% empty %}
    Žádné položky
    {% endfor %}
    <p>Cena celkem: {{ summary.price }} Kč</p>
    <form method="POST">
        {% csrf_token %}
        <button type="submit" class="btn btn-warning btn-block" {% if not can_order %} disabled {% endif %}>Objednat</button>
    </form>
</div>
<div class="container mt-2">
    <h2>Restaurace: {{ facility.name }}</h2>
    <p><i class="fas fa-thumbtack color-yellow"></i> Adresa: {{ facility.address }}</p>
    <p><i class="fas fa-clock color-yellow"></i> Otevřeno: {{ facility.opening_time }} - {{ facility.closing_time }}</p>
    {% if facility.state == 'A' %}
        <i class="fas fa-circle online-symbol"></i>
        Aktuálně příjmá objednávky
    {% elif facility.state == 'D' %}
        <i class="fas fa-circle offline-symbol"></i>
        Nepříjmá objednávky
    {% endif %}
    <form class="form-inline mt-3" method="GET">
        <input class="form-control mr-2" type="text" placeholder="Vyhledat v nabídkách">
        <select class="form-control mr-2">
            <option value="name">Jméno</option>
            <option value="type">Typ</option>
        </select>
        <button class="btn btn-warning" type="submit">Hledat <i class="fas fa-search"></i></button>
    </form>
</div>
<div class="container">
    {% for offer in facility.offers.all %}
    <div class="fd-offer-container">
        <h3>{{ offer.name }}, Typ: {% if offer.variant == 'P' %}Stálá{% elif offer.variant == 'D'%}Denní{% endif %}</h3>
        <div class="d-flex flex-wrap">
        {% for item in offer.items.all %}
            <div class="shadow m-2 p-2">
            {% comment %} Image with no image available picture when item.img is not set {% endcomment %}
            <img style="height: 200px;" class="rounded" src="{% if item.img %}{{ item.img.url }}{% endif %}"
                onerror="this.onerror=null; this.src='/static/imgs/Default.jpg'">
            <div class="mt-2">
                <h4>{{ item.name }}</h4>
                {% if item.variant != '' %}<p>Typ: {{ item.variant }}</p>{% endif %}
                {% if item.volume %}<p>Objem: {{ item.volume }}</p> {% endif %}
                <p>Cena: {{ item.price }} Kč</p>
                {% if not item.in_stock %}&times; Momentálně nedostupné{% endif %}
                <form method="GET" action="">
                    <button type="submit" class="btn btn-warning" name="add_item" value="{{ item.pk }}" {% if not item.in_stock %} disabled {% endif %}>Přidat</button>
                </form>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endfor %}
    </div>
</div>
{% endblock %}